<!DOCTYPE html>
<html lang="tn" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- FIX FAVICON ERROR (404 in Logs) -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ö°</text></svg>">

    <!-- SEO & SOCIAL SHARING -->
    <title>Vitrina TakTak | Hanoutek fi Lien</title>
    <meta name="description" content="La solution n¬∞1 en Tunisie pour vendre en ligne. Cr√©ez votre boutique, partagez votre lien, recevez vos commandes sur WhatsApp.">
    <meta name="keywords" content="boutique en ligne tunisie, vente whatsapp, e-commerce gratuit, vitrina taktak">
    <meta name="author" content="Vitrina TakTak">
    <link rel="canonical" href="https://vitrinataktak.store" />

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://vitrinataktak.store/">
    <meta property="og:title" content="Hanoutek fi Lien - Vitrina TakTak">
    <meta property="og:description" content="Arr√™tez de r√©pondre 'Prix ?'. Automatisez vos commandes WhatsApp.">
    <meta property="og:image" content="https://images.unsplash.com/photo-1556742049-0cfed4f7a07d?auto=format&fit=crop&q=80">

    <!-- LIBRARIES -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <!-- CUSTOM CONFIG -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gold: '#EAB308', 
                        dark: '#050505',
                        card: '#121212'
                    },
                    fontFamily: {
                        sans: ['Tajawal', 'sans-serif'],
                        inter: ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <style>
        .hidden { display: none !important; }
        body { background-color: #000; color: white; -webkit-tap-highlight-color: transparent; overflow-x: hidden; }
        html { scroll-behavior: smooth; }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
        
        /* Badges */
        .badge-populaire {
            position: absolute; top: 0; right: 0; background: #EAB308; color: black;
            font-size: 0.65rem; font-weight: 800; padding: 4px 12px;
            border-bottom-left-radius: 12px; border-top-right-radius: 12px;
        }
        .beta-pill {
            background: rgba(234, 179, 8, 0.15); border: 1px solid rgba(234, 179, 8, 0.3);
            color: #EAB308; font-size: 10px; padding: 2px 8px; border-radius: 99px; letter-spacing: 0.5px;
        }

        /* AdSense Placeholder */
        .ad-slot {
            width: 100%; min-height: 100px; background: #111; border: 1px dashed #333;
            display: flex; align-items: center; justify-content: center;
            color: #666; font-size: 10px; margin: 20px 0; border-radius: 8px;
        }

        /* Loader */
        .loader { border: 3px solid #333; border-top: 3px solid #EAB308; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="min-h-screen flex flex-col font-sans">

    <!-- 1. LOADING SCREEN -->
    <div id="loading-screen" class="fixed inset-0 bg-black z-[100] flex flex-col items-center justify-center">
        <div class="loader"></div>
        <div class="flex items-center gap-2 mt-4">
            <span class="text-gold text-xl">‚ö°</span>
            <p class="text-white text-sm font-bold tracking-widest">VITRINA.</p>
        </div>
    </div>

    <!-- 2. LANDING PAGE -->
    <div id="landing-page" class="hidden w-full max-w-md mx-auto min-h-screen flex flex-col bg-black">
        
        <!-- Navbar -->
        <nav class="w-full px-6 py-6 flex justify-between items-center z-40">
            <div class="flex items-center gap-2 cursor-pointer" onclick="window.location.reload()">
                <span class="text-gold text-2xl">‚ö°</span>
                <span class="font-bold text-xl tracking-wide">Vitrina <span class="text-gold">.</span></span>
            </div>
            <div class="beta-pill font-bold flex items-center gap-1">
                BETA üáπüá≥
            </div>
        </nav>

        <!-- Content -->
        <main class="flex-1 px-6 pt-6 pb-10">
            
            <!-- Headline -->
            <div class="text-center mb-10 animate-fade-in">
                <h1 id="lp-headline" class="text-5xl font-extrabold mb-4 leading-tight tracking-tight">
                    Hanoutek<br>fi Lien.
                </h1>
                <p id="lp-subhead" class="text-gray-400 text-sm font-light leading-relaxed max-w-xs mx-auto">
                    Arr√™tez de r√©pondre "Prix ?"<br>
                    Recevez des commandes claires sur whatsapp.
                </p>
            </div>

            <!-- Pricing Card -->
            <div class="bg-[#121212] rounded-2xl p-6 relative border border-white/5 shadow-2xl mb-12 animate-fade-in" style="animation-delay: 0.1s;">
                <div class="badge-populaire">POPULAIRE</div>
                
                <p class="text-[10px] text-gray-400 uppercase tracking-widest font-bold mb-1">ABONNEMENT</p>
                <div class="flex items-baseline gap-1 mb-6">
                    <span class="text-5xl font-bold text-white">30</span>
                    <span class="text-2xl font-bold text-gold">DT</span>
                    <span class="text-xs text-gray-500 ml-1">/ mois</span>
                </div>

                <button onclick="contactSales()" class="w-full bg-gold hover:bg-yellow-500 text-black font-extrabold py-4 rounded-xl text-md shadow-lg shadow-yellow-900/20 transition-transform active:scale-95 mb-4">
                    Lancer ma Boutique
                </button>

                <p class="text-center text-[10px] text-gray-600">
                    Paiement via D17 / Flouci / Sobflous
                </p>
            </div>

            <!-- Demo Button -->
            <div class="text-center mb-12 animate-fade-in" style="animation-delay: 0.2s;">
                <a href="?store=demo" class="inline-flex items-center gap-2 text-gray-300 hover:text-white transition text-sm border-b border-gray-700 pb-0.5">
                    <span>üëÅÔ∏è</span> <span id="lp-demo-text">Voir un exemple de boutique</span>
                </a>
            </div>

            <!-- Steps -->
            <h2 id="lp-steps-title" class="text-center text-xl font-bold mb-8">Kifeh temchi?</h2>

            <div class="bg-[#121212] p-4 rounded-xl flex items-center gap-4 mb-4 border border-white/5 animate-fade-in">
                <div class="w-12 h-12 rounded-full bg-[#1E1E1E] flex items-center justify-center text-2xl border border-white/5">üì∏</div>
                <div>
                    <h3 id="lp-s1-t" class="font-bold text-white">1. Eb3ath Taswira</h3>
                    <p id="lp-s1-d" class="text-xs text-gray-500">Envoyez vos photos et prix sur WhatsApp.</p>
                </div>
            </div>

            <div class="bg-[#121212] p-4 rounded-xl flex items-center gap-4 mb-8 border border-white/5 animate-fade-in">
                <div class="w-12 h-12 rounded-full bg-[#1E1E1E] flex items-center justify-center text-2xl border border-white/5">‚ö°</div>
                <div>
                    <h3 id="lp-s2-t" class="font-bold text-white">2. Hata chay ma yestanna</h3>
                    <p id="lp-s2-d" class="text-xs text-gray-500">On cr√©e votre lien en quelques minutes.</p>
                </div>
            </div>

            <!-- ADSENSE SLOT 1 -->
            <div class="ad-slot">
                <!-- Google AdSense Code Here -->
                <span>Publicit√© Google</span>
            </div>
            
            <!-- Language Switcher -->
            <div class="mt-10 flex justify-center gap-6">
                <button onclick="setLang('tn')" id="btn-tn" class="text-xs font-bold text-gold transition">TN üáπüá≥</button>
                <button onclick="setLang('fr')" id="btn-fr" class="text-xs font-bold text-gray-600 hover:text-white transition">FR üá´üá∑</button>
            </div>

            <!-- Footer & Legal -->
            <footer class="mt-12 text-center border-t border-gray-900 pt-8 pb-8">
                <div class="flex justify-center flex-wrap gap-4 mb-4 text-[11px] text-gray-500">
                    <button onclick="openModal('about')" id="foot-about" class="hover:text-gold transition">Qui sommes-nous?</button>
                    <button onclick="openModal('privacy')" id="foot-privacy" class="hover:text-gold transition">Politique de Confidentialit√©</button>
                    <button onclick="openModal('terms')" id="foot-terms" class="hover:text-gold transition">Conditions</button>
                    <a href="mailto:contact@vitrinataktak.store" class="hover:text-gold transition">Contact</a>
                </div>
                <div class="text-[10px] text-gray-600 leading-relaxed">
                    &copy; 2026 Vitrina TakTak. La r√©f√©rence du commerce en ligne en Tunisie.<br>
                    <a href="mailto:contact@vitrinataktak.store" class="text-gray-500 hover:text-white">contact@vitrinataktak.store</a>
                </div>
            </footer>

        </main>
    </div>

    <!-- 3. STORE APP (CLIENT VIEW) -->
    <div id="store-app" class="hidden flex-1 flex-col pb-32 bg-black min-h-screen">
        
        <!-- Store Header -->
        <header class="sticky top-0 z-30 bg-black/95 backdrop-blur border-b border-gray-800">
            <div class="p-4 flex justify-between items-center max-w-2xl mx-auto">
                <div>
                    <h1 id="store-name" class="text-lg font-bold text-white">Loading...</h1>
                    <p id="txt-store-verified" class="text-[10px] text-gold font-bold uppercase tracking-widest flex items-center gap-1">
                        <span class="w-1.5 h-1.5 rounded-full bg-gold"></span> VERIFIED
                    </p>
                </div>
                
                <div class="flex items-center gap-3">
                    <div onclick="toggleCartModal()" class="relative p-2 cursor-pointer bg-white/5 rounded-full hover:bg-white/10 transition">
                        <span class="text-xl">üõí</span>
                        <span id="cart-badge" class="hidden absolute -top-1 -right-1 bg-red-600 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full border border-black">0</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Product List -->
        <main id="product-list" class="p-4 grid grid-cols-2 gap-3 max-w-2xl mx-auto w-full"></main>
        
        <!-- ADSENSE SLOT 2 -->
        <div class="px-4 max-w-2xl mx-auto w-full mt-4">
            <div class="ad-slot"><span>Publicit√© Google</span></div>
        </div>
        
        <footer class="text-center py-8 text-[10px] text-gray-700 px-6">
             <p class="mb-2">Ce magasin est propuls√© par <a href="/" class="text-gold font-bold">Vitrina TakTak</a>.</p>
             <p class="text-[9px] text-gray-800 mb-2">Nous fournissons la technologie mais ne sommes pas responsables des produits vendus.</p>
             <a href="mailto:abuse@vitrinataktak.store" class="text-red-900/50 hover:text-red-500 inline-block">Signaler ce magasin</a>
             <div class="mt-4 border-t border-gray-900 pt-4 text-gray-800">
                 &copy; 2026 Vitrina TakTak. La r√©f√©rence du commerce en ligne en Tunisie.
             </div>
        </footer>
    </div>

    <!-- 4. FLOATING CART BAR -->
    <div id="cart-bar" class="hidden fixed bottom-4 left-4 right-4 z-40">
        <div class="bg-[#1A1A1A] border border-gray-700 p-4 rounded-xl shadow-2xl flex justify-between items-center max-w-2xl mx-auto">
            <div>
                <span id="txt-bar-total" class="text-gray-400 text-[10px] uppercase font-bold">Total</span><br>
                <span id="bar-total" class="text-white font-bold text-lg">0.000 DT</span>
            </div>
            <button onclick="toggleCartModal()" id="btn-view-cart" class="bg-gold text-black font-bold py-2.5 px-6 rounded-lg text-sm shadow-lg">
                VOIR PANIER
            </button>
        </div>
    </div>

    <!-- 5. CART MODAL -->
    <div id="cart-modal" class="hidden fixed inset-0 z-50 bg-black/90 backdrop-blur-md flex items-end sm:items-center justify-center">
        <div class="bg-[#121212] w-full max-w-md rounded-t-2xl sm:rounded-2xl border-t sm:border border-gray-800 p-6 flex flex-col max-h-[90vh]">
            <div class="flex justify-between items-center mb-6 border-b border-gray-800 pb-4">
                <h2 id="txt-modal-title" class="text-xl font-bold text-white">Votre Panier</h2>
                <button onclick="toggleCartModal()" class="w-8 h-8 rounded-full bg-gray-800 text-white flex items-center justify-center font-bold">‚úï</button>
            </div>
            
            <div id="cart-items-container" class="overflow-y-auto flex-1 mb-4 space-y-3 pr-2">
                <!-- Items Injected Here -->
            </div>

            <div class="border-t border-gray-800 pt-4 mt-auto">
                <div class="flex justify-between items-center mb-4">
                    <span id="txt-modal-total-label" class="text-gray-400">Total √† payer:</span>
                    <span id="modal-total" class="text-gold font-bold text-2xl">0.000 DT</span>
                </div>
                <button id="store-whatsapp-btn" class="w-full bg-[#25D366] hover:bg-[#20bd5a] text-white font-bold py-4 rounded-xl flex items-center justify-center gap-2 text-lg shadow-lg shadow-green-900/20">
                    <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"/></svg> ${t.confirm}`;

            // Refresh Product List if needed
            if(globalProductList.length > 0) renderProducts(globalProductList);
        }

        function contactSales() {
            window.open(`https://wa.me/${CONFIG.SALES_PHONE}?text=${encodeURIComponent(content[currentLang].waMsg)}`, '_blank');
        }

        // --- LEGAL & ABOUT MODALS ---
        function openModal(type) {
            const modal = document.getElementById('legal-modal');
            const title = document.getElementById('legal-title');
            const contentDiv = document.getElementById('legal-content');

            const t = content[currentLang]; // Get current language translations

            if(type === 'about') {
                title.innerText = currentLang === 'tn' ? "Chkoun A7na?" : "Qui sommes-nous ?";
                contentDiv.innerHTML = `
                    <p class="mb-4">
                        ${currentLang === 'tn' 
                        ? "<strong>Vitrina TakTak</strong> hiya platform tounsiya 100% masnou3a bach t3awen et-tejjar es-sghar w l-moyen bach ybi3ou sel3ethom en ligne b'sahla. Ma nest7a9ouch site web m3a9ed, just lien wa7ed ylamlek kol chay." 
                        : "<strong>Vitrina TakTak</strong> est une plateforme 100% tunisienne con√ßue pour aider les petits et moyens commer√ßants √† vendre en ligne facilement. Pas besoin de site web complexe, juste un lien unique qui rassemble tout."}
                    </p>
                    <p>
                        ${currentLang === 'tn'
                        ? "Hadafna howa nsahelou et-tijara elektronik fi Tounes."
                        : "Notre objectif est de simplifier le commerce √©lectronique en Tunisie."}
                    </p>
                    <p class="mt-4 text-xs text-gray-500">Contact: contact@vitrinataktak.store</p>
                `;
            } else if(type === 'privacy') {
                title.innerText = currentLang === 'tn' ? "Siyaset el Khousousiya" : "Politique de Confidentialit√©";
                contentDiv.innerHTML = `
                    <p><strong>1. Collecte de donn√©es</strong><br>Vitrina TakTak ne collecte aucune donn√©e personnelle sensible sur ce site. Les commandes sont trait√©es exclusivement via WhatsApp.</p>
                    <p><strong>2. Cookies</strong><br>Nous utilisons le stockage local (LocalStorage) pour sauvegarder votre panier.</p>
                `;
            } else {
                title.innerText = currentLang === 'tn' ? "Chourout el Isti3mal" : "Conditions d'Utilisation";
                contentDiv.innerHTML = `
                    <p><strong>1. Acceptation</strong><br>En utilisant Vitrina TakTak, vous acceptez que le service est fourni "tel quel".</p>
                    <p><strong>2. Usage Interdit</strong><br>Il est interdit de vendre des produits ill√©gaux.</p>
                `;
            }
            modal.classList.remove('hidden');
        }

        // --- STORE LOGIC ---
        async function loadStore(slug) {
            try {
                let store, products;

                if(slug === 'demo') {
                    store = { name: "Boutique Demo", phone: CONFIG.SALES_PHONE };
                    products = MOCK_PRODUCTS;
                } else {
                    const { data: s, error: sErr } = await db.from('stores').select('*').eq('slug', slug).single();
                    if(sErr || !s) throw new Error("Store not found");
                    store = s;
                    
                    const { data: p } = await db.from('products').select('*').eq('store_slug', slug).order('created_at');
                    products = p;
                }

                storePhone = store.phone;
                els.name.innerText = escapeHtml(store.name);
                document.title = store.name + " | Vitrina";

                products.forEach(p => { productsMap[p.id] = p; });
                globalProductList = products;
                renderProducts(products);
                updateTotals();
                
                // Hide loader only on success
                els.loading.classList.add('hidden');
                els.storeApp.classList.remove('hidden');

            } catch (err) {
                console.error("Store Load Error:", err);
                // On error, hide loader and show error message inside store app container
                els.loading.classList.add('hidden');
                els.storeApp.classList.remove('hidden');
                els.list.innerHTML = `<div class="col-span-2 text-center mt-20">
                    <p class="text-red-500 font-bold mb-2">Boutique introuvable.</p>
                    <a href="/" class="text-gold underline text-sm">Retour √† l'accueil</a>
                </div>`;
                els.name.innerText = "Erreur";
            }
        }

        // Security: Sanitize HTML
        function escapeHtml(text) {
            if (!text) return text;
            return text
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        function renderProducts(products) {
            if(!products || products.length === 0) { 
                els.list.innerHTML = "<p class='col-span-2 text-center text-gray-500 mt-10 text-sm'>Aucun produit disponible.</p>"; 
                return; 
            }
            
            els.list.innerHTML = products.map(p => {
                const safeName = escapeHtml(p.name);
                // SIMPLIFIED LOGIC to avoid "Template Literal in URL" error from logs
                let imgHtml = '<div class="flex h-full items-center justify-center text-gray-600 text-xs">No Img</div>';
                if (p.image) {
                     // Using strict variable insertion to prevent syntax errors
                    imgHtml = `<img src="${p.image}" class="w-full h-full object-cover">`;
                }

                const price = parseFloat(p.price).toFixed(3);
                const inCart = cart[p.id] ? cart[p.id].qty : 0;
                
                let btnHtml = inCart === 0 
                    ? `<button onclick="updateCart('${p.id}', 1)" class="mt-2 w-full bg-[#1E1E1E] hover:bg-gold hover:text-black border border-gray-700 hover:border-gold text-white text-[10px] font-bold py-3 rounded-lg transition-all active:scale-95 uppercase tracking-wider flex items-center justify-center gap-1">${content[currentLang].addBtn}</button>`
                    : `<div class="mt-2 w-full flex items-center justify-between bg-black border border-gold rounded-lg overflow-hidden h-[38px]">
                        <button onclick="updateCart('${p.id}', -1)" class="w-12 h-full text-gold hover:bg-gold hover:text-black font-bold text-lg transition flex items-center justify-center">-</button>
                        <span class="text-white text-sm font-bold">${inCart}</span>
                        <button onclick="updateCart('${p.id}', 1)" class="w-12 h-full text-gold hover:bg-gold hover:text-black font-bold text-lg transition flex items-center justify-center">+</button>
                    </div>`;

                return `
                <div class="bg-[#121212] rounded-xl overflow-hidden border border-[#222] flex flex-col shadow-lg">
                    <div class="h-36 bg-[#1A1A1A] relative">
                        ${imgHtml}
                    </div>
                    <div class="p-3 flex flex-col flex-1">
                        <h3 class="text-gray-200 font-medium text-xs line-clamp-2 h-8 leading-tight mb-1">${safeName}</h3>
                        <p class="text-gold font-bold text-md">${price} <span class="text-[10px] text-gray-500">DT</span></p>
                        ${btnHtml}
                    </div>
                </div>`;
            }).join('');
        }

        // --- CART LOGIC ---
        function updateCart(id, change) {
            if (!cart[id]) {
                const product = productsMap[id];
                if (!product) return;
                cart[id] = { qty: 0, name: product.name, price: product.price, image: product.image };
            }

            cart[id].qty += change;
            if (cart[id].qty <= 0) delete cart[id];
            
            localStorage.setItem('vt_cart', JSON.stringify(cart));
            updateTotals();
            renderProducts(globalProductList);
            if(!els.modal.classList.contains('hidden')) renderCartItems();
        }

        function updateTotals() {
            let total = 0, count = 0;
            for (let id in cart) { total += cart[id].qty * cart[id].price; count += cart[id].qty; }
            
            const txt = total.toFixed(3) + " DT";
            els.barTotal.innerText = txt;
            els.modalTotal.innerText = txt;
            els.badgeNum.innerText = count;

            if (count > 0) {
                els.badgeNum.classList.remove('hidden');
                els.cartBar.classList.remove('hidden');
            } else {
                els.badgeNum.classList.add('hidden');
                els.cartBar.classList.add('hidden');
                if(!els.modal.classList.contains('hidden')) toggleCartModal();
            }
        }

        function toggleCartModal() {
            const modal = document.getElementById('cart-modal');
            if (modal.classList.contains('hidden')) { 
                renderCartItems(); 
                modal.classList.remove('hidden'); 
            } else { 
                modal.classList.add('hidden'); 
            }
        }

        function renderCartItems() {
            let html = '';
            let msg = "Commande Vitrina: \n\n";
            let hasItems = false;
            let total = 0;

            for (let id in cart) {
                hasItems = true;
                const item = cart[id];
                const itemTotal = item.qty * item.price;
                total += itemTotal;
                const safeName = escapeHtml(item.name);
                
                html += `
                <div class="flex items-center gap-3 bg-[#1A1A1A] p-2 rounded-lg border border-[#222]">
                    <div class="w-12 h-12 bg-[#222] rounded flex-shrink-0 overflow-hidden">
                        ${item.image ? `<img src="${item.image}" class="w-full h-full object-cover">` : ''}
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="text-white text-xs font-bold truncate">${safeName}</div>
                        <div class="text-gold text-xs">${item.price.toFixed(3)} DT</div>
                    </div>
                    <div class="flex items-center gap-2 bg-black rounded border border-[#333] h-8">
                        <button onclick="updateCart('${id}', -1)" class="w-8 h-full text-gray-400 hover:text-white">-</button>
                        <span class="text-white text-xs font-bold">${item.qty}</span>
                        <button onclick="updateCart('${id}', 1)" class="w-8 h-full text-gold hover:text-white">+</button>
                    </div>
                </div>`;
                msg += `‚ñ™ ${item.qty}x ${item.name} (${itemTotal.toFixed(3)} DT)\n`;
            }

            els.modalList.innerHTML = html;

            if(hasItems) {
                msg += `\n*TOTAL: ${total.toFixed(3)} DT*`;
                els.waBtn.onclick = () => window.open(`https://wa.me/${storePhone}?text=${encodeURIComponent(msg)}`, '_blank');
            } else {
                els.modalList.innerHTML = "<p class='text-gray-500 text-center text-sm mt-10'>Votre panier est vide.</p>";
            }
        }

        // START (Wait for DOM)
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
    </html>
